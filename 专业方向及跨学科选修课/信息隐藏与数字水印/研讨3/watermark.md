### 简介

###### 医疗图像水印的性质 ：

保密性：只有被授权的人才能够获得健康数据。可以通过加密、防火墙、访问控制来实现。

可靠性：分为完整性(验证消息没有被改变)和认证(验证消息的来源)

可用性：授权用户可以去使用健康数据

###### 目前医学图像的水印方法

将医学图像分为两个区域，感兴趣区域（ROI）和非感兴趣区域（RONI）。ROI包括有医学指导意义的区域，RONI一般是指图像的背景。

主要采用空间域技术，比较直接、快速。但关键缺点是受噪声以及图像压缩方法影响较大。

目前医疗领域的算法，要么没有ROI和RONI分割，要么在空间域上实现数字水印。

### 背景介绍

###### 系统模型

![](https://raw.githubusercontent.com/Firewall12138/img/main/20220519102846.png)

水印包括病人的信息、医生的信息、该病人的诊断信息、与健康有关的数据图像的ROI部分的最小有效位LSB、以及额外存储的来检查完整性的标志。

接收者收到带有水印的医疗图像，提取水印，再用相同的密钥解码水印。

### 解决方案

作者提出一种基于小波的数字水印，具体来说使用了三级DWT和BCH编码。

三级DWT是在医疗图像的RONI上进行的，在每个分离阶段产生不同的频率自带（LL、LH、HL、HH）。图片的编码过程是在LL子带的non-overlaying blocks上完成的。嵌入水印后，再进行三级反DWT变换，得到带有水印的医疗图像。

所有需要被写进水印的信息都需要通过BCH编码器生成BCH码，从而可以修复众多的比特故障。

###### 水印嵌入方案

- 在图像的ROI部分，用LSB算法添加一个脆弱的水印。

- ROI部分的原始LSB以及病人信息、医生信息、诊断信息和标识首先用密钥进行加密，然后再插入医疗图像的RONI，作为一个更健壮的水印。

- RONI被划分为NXN的块，然后进行三级DWT处理，将上面的信息稳健水印插入到图像中，再对图像进行三级反DWT使其回到空间域。

- ROI和RONI合并

![](https://raw.githubusercontent.com/Firewall12138/img/main/20220519105415.png) 

###### 水印提取方案

- 从发送方收到的带水印的医疗图像被分为ROI和RONI

- RONI被划分成NXN的块，进行三级DWT处理。然后将健壮水印提取并解密，以获得病人信息、医生信息、诊断信息、标识以及ROI区域的原始LSB

- 再ROI部分提取脆弱的水印来测试图片的准确度，并从健壮水印中获得原始LSB来替换ROI部分的比特，以恢复原始ROI

- RONI部分经过三级反DWT处理，和ROI结合，得到原始医疗图像

### 安全分析

###### 安全参数

保密性通过两个密钥来保证。

第一个密钥是一个256x256的矩阵(由RONI转换成举证形式和一个256x256的随机矩阵合并而成)，用于在DWT分解的第一层嵌入信息。

第二个密钥是一个128 x 128的矩阵 从之前256的矩阵得来。



可靠性分为完整性和认证。完整性通过在水印信息中加入标识实现，一旦照片被篡改，解密出来的标识会有不同。认证通过在水印信息中加入病人和医生信息来实现。




