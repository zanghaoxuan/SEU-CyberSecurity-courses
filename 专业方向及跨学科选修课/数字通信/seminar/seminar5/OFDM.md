在单信道通信系统中，符号周期必须大于延迟，否则会产生符号间干扰（ISI）。数据传输速率与符号周期成反比，即符号周期越长，传输速率越低。

频分复用（FDM）将频率分为多个子带宽，使得多个信号可以并行传输。如果分配这些子带宽时使它们挨得足够近，便可以达到很高的利用率，从而达到更高的传输速率。然而，如果子带宽之间的间隙太小，又会产生信道间干扰（ICI）。为了防止 ICI，需要在子带宽之间加入保护间隔——当然，这也导致传输速率降低。

正交频分复用（OFDM）用来同时解决 ISI 和 ICI 的问题。它将许多低速载波合成为高速通信系统。而 OFDM 相比于频分复用 FDM 多出来的“正交”，使得它的载波可以紧紧挨在一起——甚至重叠——而不会产生 ICI；低速载波则使得它拥有更长的符号周期，大幅降低了 ISI。

# 背景

## OFDM 基础

OFDM 需要传输的数据首先在频域上经过 M-PSK、QAM 等方式调制，然后通过傅立叶逆变换（IDFT）——或者更多的是用快速傅立叶逆变换（IFFT）——转换为时域。然后，这些数据将会尽力占满可用频率，并行传输。在调制时，OFDM 会将数据分为一帧一帧的，这样方便接收方同步。

尽管低速载波可以大幅降低 ISI，但 OFDM 的目标是消除 ISI。OFDM 使用循环前缀来做到这一点。它将尾部的一部分数据——比如 25%——复制到头部。如此一来，解调时，识别符号长度的误差可以减小到循环前缀的长度。

OFDM 将数据分散到多个频段上传输，但这个频段数量是有限的。它不但受到可用频谱大小影响，还受制于 IFFR 的规模。具体来说，有
$$
\text{频段数量}\leq\frac{ifft\_size}{2}-2
$$
它具体的值由系统复杂度决定。系统越复杂、性能越好，能够处理 IFFT 计算的能力就越强，相应地就可以使用更多的频段，达到更好的传输速率。

M-PSK 调制的种类需要依据数据传输速率和比特误码率（BER）确定。PSK 的序数越高，需要传输的符号数量就越少，数据传输速率就越快；但由于幅度被分隔成了更多的子区域，错误率也会更高。

OFDM 信号有着很高的峰均比，因此它对峰值功率削波有着很高的容忍度。

## 正交

OFDM 的关键是保持载波正交。如果两个信号乘积的积分在一段时间内为零，那就可以说它们是正交的。两个频率为公共频率整数倍的余弦函数的成绩可以满足这一条件。即
$$
\int_0^T{\cos{\left(2\pi nf_0t\right)}\cos{\left(2\pi mf_0t\right)}\mathrm{d}t}=0(n\neq m)
$$
其中，$f_0$ 为公共频率，$T$ 为符号周期。在 OFDM 中，通常取
$$
f_0=\frac{1}{T}
$$

# Matlab 实现 OFDM

